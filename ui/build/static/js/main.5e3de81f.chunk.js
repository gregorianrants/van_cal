(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{140:function(e,t,n){var r=n(53),a=r.setHours,c=r.setMinutes;e.exports={asDecimal:function(e){var t,n,r=e.getHours(),a=e.getMinutes()/60;return t=r+a,n=2,Math.floor(t*Math.pow(10,n))/Math.pow(10,n)},getTimeFromPosition:function(e,t){var n=e/t*24,r=Math.floor(n),o=60*(n-r);return c(a(new Date,r),o)}}},246:function(e,t,n){var r=n(292),a=n(14),c=n(294),o=n(189),i=n(191),s=n(295),u=(n(136),n(53).nextDay,{name:{type:String,required:!0,validate:[{validator:function(e){return e.length>4},message:"name must have more than 4 characters"}]},mobile:{type:String,validate:{validator:function(e){return s.isMobilePhone(e,["en-GB"])},message:"must be a valid mobile number"}},email:{type:String,validate:{validator:s.isEmail,message:"must be a valid email"}}}),l=o.Schema(u),d={hourlyRate:{type:Number},fuelCharge:{type:Number},travelTime:{type:Number}},j=o.Schema(d),b={_id:{type:String,default:i},value:{validate:{validator:function(e){return e.length>4},message:"address must have more than 4 characters"},type:String}},h=o.Schema(b),f={_id:{type:String,default:i},value:{validate:{validator:function(e){return e.length>3},message:"operative must have more than 3 characters"},type:String}},p=o.Schema(f),m=new o.Schema({_id:{type:String,default:i},start:{type:Date,required:!0},end:{type:Date,required:!0},customer:l,charges:j,items:String,addresses:[h],operatives:[p],markCompleted:Boolean,sub:{type:String}}),O=o.model("Job",m,"jobs");function v(e,t,n){return{from:e+1,to:Math.min(e+t,n),of:n}}function x(){return(x=c(a.mark((function e(t){var n,r,c,o,i,s,u,l,d;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.from,r=t.to,c=t.skip,o=t.limit,i=t.sub,s={},n&&(s.start={$gte:n}),r&&(s.end={$lte:r}),s.sub=i,u=O.find(s),e.next=8,O.countDocuments(s);case 8:return l=e.sent,console.log(l),c&&o&&u.limit(Number(o)).skip(Number(c)),e.next=13,u;case 13:return d=e.sent,e.abrupt("return",{items:d,pagination:v(c,o,l),count:d.length});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(){return(g=c(a.mark((function e(t,n){var c;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=new O(r(r({},t),{},{sub:n})),e.next=3,c.save();case 3:return e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return w.apply(this,arguments)}function w(){return(w=c(a.mark((function e(t){var n;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.findById(t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(){return(k=c(a.mark((function e(t){var n;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.deleteOne({_id:t});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(){return(S=c(a.mark((function e(t,n){var r;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(t);case 2:return r=e.sent,Object.keys(n).forEach((function(e){r[e]=n[e]})),e.next=6,r.save();case 6:return e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(){return(C=c(a.mark((function e(t){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.deleteMany();case 2:return console.log(t),e.next=5,O.insertMany(t);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}e.exports={list:function(e){return x.apply(this,arguments)},create:function(e,t){return g.apply(this,arguments)},get:y,remove:function(e){return k.apply(this,arguments)},resetData:function(e){return C.apply(this,arguments)},edit:function(e,t){return S.apply(this,arguments)},jobSchema:m},t.Job=O},264:function(e,t,n){},265:function(e,t,n){},374:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(21),o=n.n(c),i=(n(264),n(265),n(107)),s=n(432),u=n(412),l=n(413),d=n(414),j=n(415),b=n(416),h=n(43),f=n(227),p=n.n(f),m=n(228),O=n.n(m),v=n(3),x=Object(i.a)((function(e){return{root:{display:"flex"},appBar:{zIndex:e.zIndex.drawer+1},drawer:{width:240,flexShrink:0},drawerPaper:{width:240},drawerContainer:{overflow:"auto"},content:{flexGrow:1,padding:e.spacing(3)},wrapper:{display:"flex"}}}));var g=function(){var e=x();return Object(v.jsx)(s.a,{className:e.drawer,variant:"permanent",classes:{paper:e.drawerPaper},children:Object(v.jsxs)("div",{className:e.drawerContainer,children:[Object(v.jsx)(u.a,{}),Object(v.jsxs)(l.a,{children:[Object(v.jsxs)(d.a,{component:h.b,to:"/calendar",children:[Object(v.jsx)(j.a,{children:Object(v.jsx)(p.a,{})}),Object(v.jsx)(b.a,{children:"Calendar"})]}),Object(v.jsxs)(d.a,{component:h.b,to:"/gcal",children:[Object(v.jsx)(j.a,{children:Object(v.jsx)(O.a,{})}),Object(v.jsx)(b.a,{children:"google calendar"})]})]})]})})},y=n(17),w=n(13),k=n(11),S=n(16),C=n(36),D=n(14),T=n.n(D),E=n(26),M=n(230),N=n(50),R=n(229),F=Object(R.a)({domain:"dev-uoqx3v5p.us.auth0.com",client_id:"FgcGbEwMZcIvyXjZJrWhzP4fgI5Zs1Lh",audience:"https://calendar-api"}),W=Object(M.a)({reducerPath:"api",baseQuery:Object(N.d)({baseUrl:"http://localhost:8000/api/v1",prepareHeaders:function(){var e=Object(E.a)(T.a.mark((function e(t,n){var r,a;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.getState,(a=r().auth.token)&&t.set("authorization","Bearer ".concat(a)),e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}),tagTypes:["Jobs"],endpoints:function(e){return{getJobs:e.query({query:function(e){var t=e.from,n=e.to;return"/jobs?from=".concat(t,"&to=").concat(n)},transformResponse:function(e){return e.data.items},providesTags:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];console.log(e);var t=["Jobs"].concat(Object(C.a)(e.map((function(e){return{type:"Jobs",id:e._id}}))));return console.log("47",t),t}}),editJob:e.mutation({query:function(e){return{url:"/jobs/".concat(e._id),method:"PUT",body:e}},invalidatesTags:function(e,t,n){return[{type:"Jobs",id:n._id}]}}),getJob:e.query({query:function(e){return{url:"/jobs/".concat(e)}},transformResponse:function(e){return e.data},providesTags:function(e,t,n){return[{type:"Jobs",id:n}]}}),addJob:e.mutation({query:function(e){return{url:"/jobs",method:"POST",body:e}},invalidatesTags:["Jobs"]}),getGcal:e.query({query:function(e){var t=e.from,n=e.to;return"/gcal/events?from=".concat(t,"&to=").concat(n)},transformResponse:function(e){return e.data.map((function(e){return function(e){var t=e.start,n=e.end,r=e.id;return Object(S.a)(Object(S.a)({},e),{},{start:t.dateTime,end:n.dateTime,type:"gcalEvent",_id:r})}(e)}))}})}}});var H=W.useGetJobsQuery,I=W.useGetJobQuery,z=W.useEditJobMutation,P=W.useAddJobMutation,A=W.useGetGcalQuery,L=W.usePrefetch,J=Object(k.d)({name:"errors",initialState:{message:"",status:null,statusCode:null},reducers:{clearErrors:function(e,t){return{message:"",status:null,statusCode:null}}},extraReducers:function(e){e.addMatcher(W.endpoints.getJobs.matchRejected,(function(e,t){var n,r,a=t.payload;a&&(e.message=null===(n=a.data)||void 0===n?void 0:n.message,e.status=null===(r=a.data)||void 0===r?void 0:r.status,e.statusCode=a.status)}))}}),B=J.actions.clearErrors,G=J.reducer;function _(){var e=Object(w.e)((function(e){return e.errors.statusCode})),t=Object(w.e)((function(e){return e.errors.message})),n=Object(y.g)(),r=Object(y.h)(),a=Object(w.d)();return Object(v.jsxs)("div",{children:[Object(v.jsx)("h1",{children:"Oops something went wrong"}),Object(v.jsxs)("p",{children:["error code: ",e]}),Object(v.jsxs)("p",{children:["error message: ",t]}),Object(v.jsx)("button",{onClick:function(){a(B()),n.push(r.state.from)},children:"Go Back"})]})}var q=n(131),V=["children"];function Y(e){var t=e.children,n=Object(q.a)(e,V),r=Object(w.e)((function(e){return e.errors.status}));return Object(v.jsx)(y.b,Object(S.a)(Object(S.a)({},n),{},{render:function(e){var n=e.location;return r?Object(v.jsx)(y.a,{to:{pathname:"/error",state:{from:n}}}):t}}))}var U=["children"];function Q(e){var t=e.children,n=Object(q.a)(e,U),r=Object(w.e)((function(e){return e.auth.isAuthenticated}));return Object(v.jsx)(y.b,Object(S.a)(Object(S.a)({},n),{},{render:function(e){var n=e.location;return r?t:Object(v.jsx)(y.a,{to:{pathname:"/login",state:{from:n}}})}}))}var Z=a.a.createContext(),$=n(23),X=n(24),K=n(154),ee=n(136),te=n(53),ne=te.addDays,re=te.format,ae=te.nextMonday,ce=te.isSameDay;function oe(e){var t=[0,1,2,3,4,5,6].map((function(t){return t-function(e){return 0===(t=e.getDay())?6:t-1;var t}(e)}));return t.map((function(t){return ne(e,t)}))}function ie(e){return"".concat(re(e,"MMM")," ").concat(re(e,"yyyy"))}var se=function(e,t){var n=t.getHours(),r=t.getMinutes();return Object(K.a)(Object(ee.default)(e,n),r)};function ue(e){return Object(K.a)(Object(ee.default)(e,0),0)}function le(e){return ue(ne(e,1))}var de,je,be,he,fe={weekContaining:oe,dayOfWeek:function(e){return re(e,"iii")},monthAndYear:ie,addDays:ne,previousMonday:function(e){var t=ae(ne(e,-7));return t.setHours(0),t.setMinutes(0),t},fitsInWeek:function(e,t){var n=ne(e,7);return!(!ce(e,t)&&!ce(n,t))||t>=e&&t<=n},mergeDateAndTime:se,startOfDay:ue,endOfDay:le},pe=X.a.div(de||(de=Object($.a)(["\n/*height: 80px;*/\n    text-align: center;\n    display: flex;\n    border-top: 1px solid lightgray;\n    height: 100%;\n    width: 100%;\n    border-bottom: 1px solid lightgray;\n    \n    .day{\n      flex: 1 0 0;\n      //TODO had a bit of problem here i getting borders line up\n      //with those from day ithink its todo with the way flex distributes \n      //extra space need to look into math of grow and shrink\n      border-left: 1px solid var(--border-color-light);\n      align-items: stretch;\n\n      &:last-child{\n        border-right: 1px solid var(--border-color-light);\n      }\n      \n      p {\n        margin: 0.5em auto 0.5em;\n      }\n  }\n"])));function me(e){var t=e.days;return Object(v.jsx)(pe,{children:t.map((function(e,t){return Object(v.jsxs)("div",{className:"day",children:[Object(v.jsx)("p",{children:fe.dayOfWeek(e)}),Object(v.jsx)("p",{children:e.getDate()})]},t)}))})}var Oe=X.a.div(je||(je=Object($.a)(["\n  display: flex;\n  flex: 0 0 60px;\n"]))),ve=X.a.div(be||(be=Object($.a)(["\n  flex: 0 0 15px;\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  \n  div{\n    flex: 1 0 0;\n  }\n  p {\n    color: grey;\n    margin: 0;\n    padding: 0;\n    font-size: 12px;\n    //transform: translateY(-7px);//TODO this is just a value i tried that seems to work NOW need to look a the math though so it works for all settings\n    margin-top: -7px;\n  }\n"]))),xe=X.a.div(he||(he=Object($.a)(["\n  flex: 1 0 30px;\n  \n  display: flex;\n  flex-direction: column;\n  & .tick-line{\n    flex: 1 0 0;\n    width: 100%;\n    border-top: 1px solid lightgray;\n\n    &:last-child{\n      border-bottom: 1px solid var(--border-color-light);\n    }\n  }\n"])));function ge(){var e=a.a.useContext(Z),t=e.borderWidth,n=e.hourHeight;return Object(v.jsx)(ve,{hourHeight:n,borderWidth:t,children:Object(C.a)(Array(24).keys()).map((function(e){return Object(v.jsx)("div",{className:"tick-value",children:Object(v.jsx)("p",{children:e})},e)}))})}function ye(){var e=a.a.useContext(Z),t=e.borderWidth,n=e.hourHeight;return Object(v.jsx)(xe,{hourHeight:n,borderWidth:t,children:Object(C.a)(Array(24).keys()).map((function(e){return Object(v.jsx)("div",{className:"tick-line",height:n,border:t},e)}))})}function we(e){var t=e.headerHeight,n=a.a.useContext(Z),r=n.borderWidth,c=n.hourHeight;return Object(v.jsxs)(Oe,{headerHeight:t,children:[Object(v.jsx)(ge,{}),Object(v.jsx)(ye,{height:c,border:r})]})}var ke=n(417),Se=n(69),Ce=n(418),De=n(419);function Te(e){var t=e.currentDate,n=e.incrementWeek,r=e.decrementWeek;return Object(v.jsxs)(u.a,{children:[Object(v.jsx)(ke.a,{onClick:r,children:Object(v.jsx)(Ce.a,{})}),Object(v.jsx)(Se.a,{variant:"h4",children:ie(t)}),Object(v.jsx)(ke.a,{onClick:n,children:Object(v.jsx)(De.a,{})})]})}var Ee=n(32),Me=n(206);var Ne=n(234),Re=n(133),Fe=n.n(Re);function We(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(Ee.a)(new Date(e),7*t),r=oe(n),a=ue(new Date(r[0])),c=le(new Date(r[r.length-1]));return{currentDate:n.toISOString(),days:r.map((function(e){return e.toISOString()})),firstDay:a.toISOString(),lastDay:c.toISOString()}}var He=Object(S.a)(Object(S.a)({},We(new Date)),{},{events:[],gcalEvents:[],scrollPosition:300}),Ie=Object(k.d)({name:"calendar",initialState:He,reducers:{dataLoaded:function(e,t){e.events=t.payload},gcalDataLoaded:function(e,t){e.gcalEvents=t.payload},incrementWeek:function(e,t){return Object(S.a)(Object(S.a)({},We(e.currentDate,1)),{},{events:[],gcalEvents:[]})},decrementWeek:function(e){return Object(S.a)(Object(S.a)({},We(e.currentDate,-1)),{},{events:[],gcalEvents:[]})},editJob:function(e,t){var n=t.payload,r=e.events.findIndex((function(e){return e._id==n._id}));-1!==r&&(e.events[r]=Object(Ne.a)(n))},createJob:function(e,t){e.events.push(t.payload)},updateScrollPositions:function(e,t){e.scrollPosition=t.payload}}}),ze=Ie.actions,Pe=(ze.updateScrollPositions,function(e,t){e(ze.incrementWeek())}),Ae=function(e,t){e(ze.decrementWeek())},Le=function(e){return Object(Me.a)(e.calendar.currentDate)},Je=function(e){return e.calendar.days.map((function(e){return Object(Me.a)(e)}))},Be=Ie.reducer,Ge=n(33);function _e(e,t){return t-e}var qe=function(e,t){return Math.round(e/t)*t},Ve=n(140);var Ye,Ue,Qe,Ze=n(124),$e=X.a.p(Ye||(Ye=Object($.a)(["\n  font-family: Roboto;\n  font-size: 12px;\n  margin-top: 0px;\n  color: white;\n  font-weight: 500;\n"]))),Xe=X.a.p(Ue||(Ue=Object($.a)(["\n  font-family: Roboto;\n  font-size: 12px;\n  margin-top: 0px;\n  color: white;\n  font-weight: 500;\n  margin-bottom: 0;\n"])));function Ke(e){var t=e.start,n=e.end,r=e.summary;return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(Xe,{children:Object(Ze.a)(t,"p")+" - "+Object(Ze.a)(n,"p")}),Object(v.jsx)($e,{variant:"subtitle2",children:r})]})}var et,tt=X.a.div(Qe||(Qe=Object($.a)(["\n  position: absolute;\n  background-color: ",";\n  border: 0.5px solid white;\n  cursor: ",";\n  padding: 0.25rem;\n"])),(function(e){return e.backgroundColor}),(function(e){return e.overEdge?"row-resize":"default"}));function nt(e){var t=e.top,n=e.bottom,r=e.left,c=e.right,o=e._id,i=e.start,s=e.end,u=e.customer,l=e.backgroundColor,d=void 0===l?"red":l,j=a.a.useState(t),b=Object(Ge.a)(j,2),h=b[0],f=b[1],p=a.a.useState(n),m=Object(Ge.a)(p,2),O=m[0],x=m[1],g=a.a.useContext(Z).hourHeight,k=Object(y.g)(),S=(Object(w.d)(),z()),C=Object(Ge.a)(S,2),D=C[0];C[1].isLoading;a.a.useEffect((function(){f(t),x(n)}),[t,n]);var T=function(){var e=a.a.useState(!1),t=Object(Ge.a)(e,2),n=t[0],r=t[1];return{isCursorOverEdgeState:n,handleMouseMove:function(e){var t=e.target.getBoundingClientRect().bottom,n=e.clientY;r(n<t&&n>t-10)},handleMouseLeave:function(e){r(!1)}}}(),E=T.isCursorOverEdgeState,M=T.handleMouseMove,N=T.handleMouseLeave;function R(e){return Object(Ve.getTimeFromPosition)(e,24*g)}function F(e){return Object(Ve.getTimeFromPosition)(24*g-e,24*g)}var W=a.a.useRef(0),H=a.a.useRef(0),I=a.a.useRef(0),P=function(e,t,n,r,c){var o=a.a.useState(!1),i=Object(Ge.a)(o,2),s=i[0],u=i[1],l=a.a.useRef(0),d=a.a.useCallback((function(e){l.current+=e.movementY,t(l.current,e.movementY)}),[t]),j=a.a.useCallback((function(e){l.current+=e.movementY,n(l.current,e.movementY)}),[n]),b=a.a.useCallback((function(e){u(!1),r(l.current)}),[r]);return a.a.useEffect((function(){return"body"===s&&(window.addEventListener("mousemove",d),window.addEventListener("mouseup",b)),"edge"===s&&(window.addEventListener("mousemove",j),window.addEventListener("mouseup",b)),function(){window.removeEventListener("mousemove",d),window.removeEventListener("mousemove",j),window.removeEventListener("mouseup",b)}}),[s,d,j,b]),function(t){t.preventDefault(),u(c?"edge":"body"),e(),l.current=0}}(a.a.useCallback((function(){H.current=h,I.current=O,W.current=_e(O,24*g)-h}),[h,O,g]),(function(e){var t=H.current+e,n=qe(t,g);f(n);var r=function(e,t){return t-e}(n+W.current,24*g);x(r)}),(function(e,t){var n=I.current-e,r=qe(n,g);_e(r,24*g)>h&&x(r)}),(function(e){console.log(e),0!==e?D({_id:o,start:se(i,R(h)),end:se(s,F(O))}):k.push("calendar/job-details/".concat(o))}),E);return Object(v.jsx)(tt,{"data-component":"event","data-id":o,className:"event",onMouseDown:function(e){P(e)},onMouseMove:M,onMouseLeave:N,overEdge:E,draggable:"false",backgroundColor:d,style:{backgroundColor:d,top:h+"px",bottom:O+"px",left:r,right:c},children:Object(v.jsx)(Ke,{start:i,end:s,summary:u.name})})}var rt=X.a.div(et||(et=Object($.a)(["\n  position: absolute;\n  background-color: blue;\n  border: 0.5px solid white;\n  cursor: ",";\n  padding: 0.25rem;\n"])),(function(e){return e.overEdge?"row-resize":"default"}));function at(e){var t=e.top,n=e.bottom,r=e.left,c=e.right,o=e._id,i=e.start,s=e.end,u=(e.updateEvent,e.updateDisplayEvent,e.summary),l=a.a.useState(t),d=Object(Ge.a)(l,2),j=d[0],b=d[1],h=a.a.useState(n),f=Object(Ge.a)(h,2),p=f[0],m=f[1],O=Object(y.g)();return a.a.useEffect((function(){b(t),m(n)}),[t,n]),Object(v.jsx)(rt,{"data-component":"event","data-id":o,className:"event",style:{top:j+"px",bottom:p+"px",left:r,right:c},onClick:function(){O.push("/calendar/gcal-details/".concat(o))},children:Object(v.jsx)(Ke,{start:i,end:s,summary:u})})}var ct=function(){var e=0;return function(){return e++}}();function ot(e){return t=function(e){return e.map((function(e){return e.start})).reduce((function(e,t){return new Date(Math.min(e,t))}))}(e),n=function(e){return e.map((function(e){return e.end})).reduce((function(e,t){return new Date(Math.max(e,t))}))}(e),{start:t,end:n,id:ct()};var t,n}function it(e,t){return e.start<t.end&&t.start<e.end}function st(e,t){var n=e.map((function(e){return e._id}));return t.filter((function(e){return!n.includes(e._id)}))}function ut(e,t){return(n=e,Object(C.a)(n).sort((function(e,t){return e.start-t.start}))).reduce((function(e,n){return 0===e.length||t(n,ot(e))?[].concat(Object(C.a)(e),[n]):e}),[]);var n}function lt(e){return function(t){return ut(t,e)}}function dt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(0===e.length)return n;var r=t(e);return dt(st(r,e),t,[].concat(Object(C.a)(n),[r]))}function jt(e){return function(t){return dt(t,e,[])}}function bt(e,t){var n=function(e,t){var n=function(e){return Math.floor(e)};return function(r){return r=Object(Ve.asDecimal)(r),n(r)*e+(n(r)+1)*t+e*function(e){return e-n(e)}(r)}}(e,t),r=function(e){return 100/e.length},a=function(e,t){return e*r(t)};function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t>0?e.reduce((function(e,n){return e.concat(Array.isArray(n)?c(n,t-1):n)}),[]):e.slice()}return function(t){var o=function(e){var t=jt(lt(it))(e).map((function(e){return jt(lt((t=it,function(){return!t.apply(void 0,arguments)})))(e);var t}));return t}(t).map((function(t){return t.map((function(c,o){return c.map((function(c,i){return function(t,c,o){var i=t.start,s=t.end;return Object(S.a)(Object(S.a)({},t),{},{top:n(i),bottom:24*e-n(s),left:String(a(c,o))+"%",right:String(100-(a(c,o)+r(o)))+"%"})}(c,o,t)}))}))}));return c(o,1/0)}}var ht=["batch"];function ft(e,t){return e.map((function(e){return Object(S.a)(Object(S.a)({},e),{},{batch:t})}))}function pt(e){return e.map((function(e){return function(e){return e.batch,Object(q.a)(e,ht)}(e)}))}var mt=n(74),Ot=function(e){return function(t){return t.filter((function(t){return new Date(t.start).getDay()===e.getDay()}))}};var vt=function(e){return e.map((function(e){return function(e){return Object(S.a)(Object(S.a)({},e),{},{start:Object(Me.a)(e.start),end:Object(Me.a)(e.end)})}(e)}))};function xt(e){var t=e.date,n=bt(a.a.useContext(Z).hourHeight,0),c=L("getGcal"),o=Object(w.e)((function(e){return e.calendar.firstDay})),i=Object(w.e)((function(e){return e.calendar.lastDay}));a.a.useEffect((function(){c({from:i,to:Object(Ee.a)(new Date(i),7).toISOString()}),c({from:Object(Ee.a)(new Date(o),-7).toISOString(),to:o})}),[o,i]);var s=Object(r.useMemo)((function(){return Object(mt.a)((function(e){return e.data||[]}),(function(e,t){return t}),(function(e,t){return Fe()(vt,Ot(t))(e)}))}),[]),u=H({from:o,to:i},{selectFromResult:function(e){return{jobsForDate:s(e,t)}}}).jobsForDate,l=Object(r.useMemo)((function(){return Object(mt.a)((function(e){return e.data||[]}),(function(e,t){return t}),(function(e,t){return Fe()(vt,Ot(t))(e)}))}),[]),d=function(e,t,n){var r=n([].concat(Object(C.a)(ft(e,1)),Object(C.a)(ft(t,2)))),a=r.filter((function(e){return 1===e.batch})),c=r.filter((function(e){return 2===e.batch}));return[pt(a),pt(c)]}(u,A({from:o,to:i},{selectFromResult:function(e){return{gcalForDate:l(e,t)}}}).gcalForDate||[],n),j=Object(Ge.a)(d,2),b=j[0],h=j[1];return[].concat(Object(C.a)(b.map((function(e,t){return Object(r.createElement)(nt,Object(S.a)(Object(S.a)({},e),{},{key:e._id}))}))),Object(C.a)(h.map((function(e,t){return Object(r.createElement)(at,Object(S.a)(Object(S.a)({},e),{},{key:e.id}))}))))}var gt,yt,wt,kt,St,Ct,Dt,Tt,Et=n(205),Mt=X.a.div(gt||(gt=Object($.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n"]))),Nt=X.a.div(yt||(yt=Object($.a)(["\n  flex: 1 0 0;\n  border-top: 1px dotted lightgray;\n  scroll-snap-align: center;  //this also requires snap-type property on Scroll Portal component\n\n  &:last-child {\n    border-bottom: ",";\n  }\n  \n  \n  \n"])),(function(e){return"".concat(e.borderWidth,"px solid var(--border-color-light)")}));function Rt(e){var t=e.className,n=e.date,r=a.a.useContext(Z),c=r.borderWidth,o=r.hourHeight,i=Object(y.g)();return Object(v.jsx)(Mt,{children:Object(C.a)(Array(24).keys()).map((function(e){return Object(v.jsx)(Nt,{"data-hour":String(e),hourHeight:o,borderWidth:c,className:t,draggable:"false",onClick:function(){return t=e,void i.push("/calendar/create-job-form?hour=".concat(String(t),"&iso-date=").concat(Object(Et.a)(n,{representation:"date"})));var t}},e)}))})}var Ft,Wt=X.a.div(wt||(wt=Object($.a)(["\n  margin: 5px;\n"]))),Ht=X.a.div(kt||(kt=Object($.a)(["\n  flex: 0 0 60px;\n"]))),It=X.a.div(St||(St=Object($.a)(["\n  display: flex;\n  background-color: transparent;\n\n  &:nth-child(2) {\n    flex: 1 0 0;\n  }\n"]))),zt=X.a.div(Ct||(Ct=Object($.a)(["\n  display: flex;\n  height: ",";\n  flex: 1 0 0;\n"])),(function(e){return"".concat(24*e.hourHeight,"px")})),Pt=X.a.div(Dt||(Dt=Object($.a)(["\n  position: relative;\n  //TODO had a bit of problem here i getting borders line up\n  //with those from Header ithink its todo with the way flex distributes \n  //extra space need to look into math of grow and shrink\n  border-left: 1px solid var(--border-color-light);\n  flex: 1 0 0;\n\n  &:last-child {\n    border-right: 1px solid var(--border-color-light);\n  }\n"]))),At=X.a.div(Tt||(Tt=Object($.a)(["\n  width: 100%;\n  overflow: scroll;\n  margin: 0;\n  padding: 0;\n  height: 80vh;\n  //also requires scroll-snap-align property on Hours component\n  //Todo consider making more elegant e.g. not having components depending on css in other components\n  scroll-snap-type: y mandatory;  \n  &::-webkit-scrollbar {\n    display: none;\n  }\n\n"])));function Lt(){var e=Object(w.d)(),t=a.a.useContext(Z).hourHeight;a.a.useState(0).scrollPosition;var n=a.a.useRef(null),r=a.a.useRef(null);a.a.useEffect((function(){r.current||(n.current.scrollTop=300,console.log(n.current.scrollTop),r.current=!0)}),[n]);var c=Object(w.e)(Le),o=Object(w.e)(Je);return Object(v.jsx)(a.a.Fragment,{children:Object(v.jsxs)(Wt,{hourHeight:t,children:[Object(v.jsxs)(It,{children:[Object(v.jsx)(Ht,{className:"corner"}),Object(v.jsx)(Te,{currentDate:c,incrementWeek:function(){e(Pe)},decrementWeek:function(){e(Ae)}})]}),Object(v.jsxs)(It,{children:[Object(v.jsx)(Ht,{}),Object(v.jsx)(me,{days:o})]}),Object(v.jsx)(At,{ref:n,children:Object(v.jsxs)(It,{children:[Object(v.jsx)(we,{}),Object(v.jsx)(zt,{hourHeight:t,children:o.map((function(e,t){return Object(v.jsxs)(Pt,{children:[Object(v.jsx)(xt,{date:e}),Object(v.jsx)(Rt,{date:e})]},t)}))})]})})]})})}var Jt=X.a.div(Ft||(Ft=Object($.a)(["\n  position: fixed;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background-color: rgba(1, 1, 1, 0.2);\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n"])));function Bt(e){var t=e.children;return Object(v.jsx)(Jt,{children:t})}var Gt=n(420),_t=n(421),qt=n(422),Vt=n(377),Yt=n(242),Ut=n.n(Yt),Qt=n(129),Zt=n.n(Qt),$t=n(237),Xt=n.n($t),Kt=n(238),en=n.n(Kt),tn=n(239),nn=n.n(tn),rn=n(240),an=n.n(rn),cn=n(241),on=n.n(cn),sn=n(423),un=Object(i.a)((function(e){return{title:{fontSize:14,fontWeight:"bold",fontVariant:"small-caps",color:"#324191"},group:{marginBottom:"0.5em"},content:{paddingTop:0},li:{listStyle:"none",padding:0,margin:0},container:{marginTop:20,backgroundColor:"#F3F3FB"},list:{padding:0,"& > li":{padding:0}},pricing:{marginTop:e.spacing(2),textAlign:"center"},items:{whiteSpace:"pre-line"},row:{marginTop:e.spacing(2)}}}));function ln(e){e.displayEvent,e.close,e.updateEvent;var t=un(),n=Object(y.h)();console.log(n.pathname);var r=Object(y.g)(),a=Object(y.i)().id;console.log(a);var c=I(a),o=c.data,i=c.isFetching;console.log(o),console.log(i);var s=function(e){var n=e.customer;return Object(v.jsxs)(Gt.a,{className:t.card,children:[Object(v.jsx)(_t.a,{title:"Customer Details"}),Object(v.jsx)(qt.a,{children:Object(v.jsxs)(l.a,{className:t.list,children:[Object(v.jsxs)(d.a,{children:[Object(v.jsx)(j.a,{children:Object(v.jsx)(Xt.a,{})}),Object(v.jsx)(b.a,{primary:n.name,secondary:"name"})]}),Object(v.jsxs)(d.a,{children:[Object(v.jsx)(j.a,{children:Object(v.jsx)(en.a,{})}),Object(v.jsx)(b.a,{primary:n.mobile,secondary:"mobile"})]}),Object(v.jsxs)(d.a,{children:[Object(v.jsx)(j.a,{children:Object(v.jsx)(nn.a,{})}),Object(v.jsx)(b.a,{primary:n.email,secondary:"email"})]})]})})]})},u=function(e){var n=e.charges;return Object(v.jsxs)(sn.a,{container:!0,spacing:1,className:t.pricing,children:[Object(v.jsx)(sn.a,{item:!0,xs:4,children:Object(v.jsx)(Gt.a,{children:Object(v.jsx)(_t.a,{title:n.hourlyRate,subheader:"per hour"})})}),Object(v.jsx)(sn.a,{item:!0,xs:4,children:Object(v.jsx)(Gt.a,{children:Object(v.jsx)(_t.a,{title:n.fuelCharge,subheader:"fuel charge"})})}),Object(v.jsx)(sn.a,{item:!0,xs:4,children:Object(v.jsx)(Gt.a,{children:Object(v.jsx)(_t.a,{title:n.travelTime,subheader:"travel time"})})})]})},h=function(e){var n=e.start,r=e.end;return console.log(typeof Ze.a),Object(v.jsxs)(sn.a,{container:!0,spacing:1,className:t.pricing,children:[Object(v.jsx)(sn.a,{item:!0,xs:4,children:Object(v.jsx)(Gt.a,{children:Object(v.jsx)(_t.a,{title:Object(Ze.a)(new Date(n),"PP"),subheader:"date"})})}),Object(v.jsx)(sn.a,{item:!0,xs:4,children:Object(v.jsx)(Gt.a,{children:Object(v.jsx)(_t.a,{title:Object(Ze.a)(new Date(n),"p"),subheader:"start time"})})}),Object(v.jsx)(sn.a,{item:!0,xs:4,children:Object(v.jsx)(Gt.a,{children:Object(v.jsx)(_t.a,{title:Object(Ze.a)(new Date(r),"p"),subheader:"end time"})})})]})},f=function(e){var t=e.operatives;return Object(v.jsxs)(Gt.a,{children:[Object(v.jsx)(_t.a,{title:"operatives"}),Object(v.jsx)(l.a,{children:(t||[]).map((function(e){return Object(v.jsxs)(d.a,{children:[Object(v.jsx)(j.a,{children:Object(v.jsx)(an.a,{})}),Object(v.jsx)(b.a,{primary:e.value})]})}))})]})},p=function(e){var n=e.addresses,r=void 0===n?[]:n;return Object(v.jsxs)(Gt.a,{className:t.row,children:[Object(v.jsx)(_t.a,{title:"Addresses"}),Object(v.jsx)(l.a,{children:r.map((function(e){return Object(v.jsxs)(d.a,{children:[Object(v.jsx)(j.a,{children:Object(v.jsx)(on.a,{})}),Object(v.jsx)(b.a,{primary:e.value})]})}))})]})};if(i)return null;var m=o.customer,O=o.charges,x=o.items,g=o.addresses,w=o.operatives,k=o.start,S=o.end;return Object(v.jsx)(Bt,{children:Object(v.jsxs)(Gt.a,{style:{width:1200,backgroundColor:"#F3F3FB"},children:[Object(v.jsx)(_t.a,{title:m.name,action:Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(Vt.a,{onClick:function(){r.push("/calendar/edit-job-form/".concat(a))},children:Object(v.jsx)(Ut.a,{})}),Object(v.jsx)(Vt.a,{onClick:function(){r.push("/calendar")},children:Object(v.jsx)(Zt.a,{})})]})}),Object(v.jsx)(_t.a,{}),Object(v.jsx)(qt.a,{className:t.content,children:Object(v.jsxs)(sn.a,{container:!0,spacing:3,children:[Object(v.jsxs)(sn.a,{item:!0,xs:4,children:[Object(v.jsx)(s,{customer:m}),Object(v.jsx)(u,{charges:O}),Object(v.jsx)(h,{start:k,end:S})]}),Object(v.jsx)(sn.a,{item:!0,xs:4,children:Object(v.jsxs)(Gt.a,{children:[Object(v.jsx)(_t.a,{title:"Items"}),Object(v.jsx)(qt.a,{className:t.items,children:x})]})}),Object(v.jsxs)(sn.a,{item:!0,xs:4,children:[Object(v.jsx)(f,{operatives:w}),Object(v.jsx)(p,{addresses:g})]})]})})]})})}var dn,jn=n(243),bn=n.n(jn),hn=n(244),fn=n.n(hn),pn=n(62),mn=Object(i.a)((function(e){return{header:{paddingBottom:0},content:{paddingTop:0,overflowY:"auto",maxHeight:"85vh"},description:{whiteSpace:"pre-wrap"},modal:{width:448},toolbar:{justifyContent:"flex-end",minHeight:0,paddingTop:e.spacing(2)},list:{paddingTop:0},firstItem:{paddingTop:0}}}));X.a.div(dn||(dn=Object($.a)(["\n  top: auto;\n  bottom: auto;\n  left: auto;\n  right: auto;\n  position: absolute;\n"])));function On(){var e=Object(y.i)().id,t=Object(y.g)();console.log(e);var n=mn(),a=Object(r.useMemo)((function(){return Object(mt.a)((function(e){return console.log(e.data),e.data||[]}),(function(e,t){return t}),(function(e,t){var n;console.log(e),console.log(t);var r=null!==(n=null===e||void 0===e?void 0:e.find((function(e){return e.id===t})))&&void 0!==n?n:{};return console.log(r),r}))}),[]),c=Object(w.e)((function(e){return e.calendar.firstDay})),o=Object(w.e)((function(e){return e.calendar.lastDay})),i=A({from:c,to:o},{selectFromResult:function(t){return{gcalEvent:a(t,e)}}}).gcalEvent;console.log(i);i.summary;var s,h=new Date(null===i||void 0===i?void 0:i.start),f=new Date(null===i||void 0===i?void 0:i.end);return console.log(h),Object(v.jsx)(Bt,{children:Object(v.jsxs)(Gt.a,{className:n.modal,children:[Object(v.jsx)(u.a,{className:n.toolbar,children:Object(v.jsx)(Vt.a,{children:Object(v.jsx)(Zt.a,{onClick:function(){t.push("/calendar")}})})}),Object(v.jsx)(qt.a,{className:n.content,children:Object(v.jsxs)(l.a,{className:n.list,children:[Object(v.jsxs)(d.a,{className:n.firstItem,children:[Object(v.jsx)(j.a,{children:Object(v.jsx)(bn.a,{})}),Object(v.jsx)(b.a,{primary:i.summary,secondary:function(e,t){return Object(pn.a)(e,t)?Object(Ze.a)(e,"EEEE do MMM H':'mm")+" - "+Object(Ze.a)(t,"H':'mm"):Object(Ze.a)(e,"EEEE do MMM H':'mm")+" - "+Object(Ze.a)(e,"EEEE do MMM H':'mm")}(h,f),primaryTypographyProps:{variant:"h5"}})]}),Object(v.jsxs)(d.a,{alignItems:"flex-start",children:[Object(v.jsx)(j.a,{children:Object(v.jsx)(fn.a,{})}),Object(v.jsx)(b.a,{primary:(s=null===i||void 0===i?void 0:i.description,s?s.replace("<html-blob>","").replaceAll("<br><br>","\n").replaceAll("<br>","").replaceAll(/<[^<>]+>/gi,""):""),className:n.description,primaryTypographyProps:{variant:"body2"}})]})]})})]})})}var vn=n(189),xn=n.n(vn),gn=n(93),yn=n(190),wn=n(424),kn=n(425),Sn=n(429),Cn=n(245),Dn=n.n(Cn),Tn=n(191),En=n.n(Tn),Mn=n(20);function Nn(e){var t=e.name,n=e.value,r=void 0===n?[]:n,c=e.onChange,o=e.label,i=e.errors,s=e.itemName;var u=function(e,n){var r=Object(Mn.c)(e,(function(e){e.push(function(e){return{_id:En()(),value:e}}(n))}));c({target:{value:r,name:t}})},j=a.a.useState(""),h=Object(Ge.a)(j,2),f=h[0],p=h[1];function m(e){return i&&i[e]?i[e].value:null}return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(l.a,{dense:!0,children:r&&r.map((function(e,n){return Object(v.jsxs)(d.a,{children:[Object(v.jsx)(wn.a,{children:Object(v.jsx)(Dn.a,{})}),Object(v.jsx)(b.a,{primary:Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(Se.a,{variant:"body1",display:"inline",children:e.value}),m(n)?Object(v.jsx)(Se.a,{variant:"caption",color:"error",children:"  - ".concat(m(n))}):Object(v.jsxs)(Se.a,{variant:"caption",children:[" ","- ",s,n+1]})]}),disableTypography:!0}),Object(v.jsx)(kn.a,{children:Object(v.jsx)(Zt.a,{color:"primary",onClick:function(n){n.preventDefault(),function(e,n){var r=Object(Mn.c)(e,(function(e){return e.filter((function(e){return e._id!==n}))}));c({target:{value:r,name:t}})}(r,e._id)}})})]},e._id)}))}),Object(v.jsxs)(sn.a,{item:!0,children:[Object(v.jsx)(Sn.a,{label:o,value:f,fullWidth:!0,onChange:function(e){p(e.target.value)}}),Object(v.jsx)("button",{onClick:function(e){e.preventDefault(),u(r,f),p("")},children:"+"})]})]})}var Rn,Fn=n(177),Wn=n(34),Hn=n(434),In=n(427),zn=n(246),Pn=n(190).set;function An(e){return"ValidatorError"===e.name}function Ln(e){return e.message}function Jn(e){return"CastError"===e.name}function Bn(e){return"should be a ".concat(e.kind)}function Gn(e){if(!e)return null;for(var t={},n=0,r=Object.entries(e.errors);n<r.length;n++){var a=Object(Ge.a)(r[n],2),c=a[0],o=a[1],i=c.replace(/\d+/g,(function(e){return"[".concat(e,"]")}));console.log(i),Jn(o)?Pn(t,i,Bn(o)):An(o)&&Pn(t,i,Ln(o))}return t}function _n(e,t){var n=t.getHours(),r=t.getMinutes(),a=new Date(e);return a.setHours(n),a.setMinutes(r),a}var qn=X.a.div(Rn||(Rn=Object($.a)(["\n  display: flex;\n"]))),Vn=Object(i.a)({flexItem:{flex:"1 1 0","&:not(:last-child)":{marginRight:"10px"}},inputRow:{marginBottom:"10px"},textField:{"& textarea":{whiteSpace:"pre-line"}}});function Yn(e){var t=e.initialValues,n=e.title,r=e.handleSubmit,a=Vn(),c=function(){var e=Object(E.a)(T.a.mark((function e(t){var n,r,a;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new xn.a.Document(t,zn.jobSchema),e.next=3,n.validateSync();case 3:return r=e.sent,a=Gn(r),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsx)(Bt,{children:Object(v.jsxs)(Gt.a,{children:[Object(v.jsx)(_t.a,{title:n}),Object(v.jsx)(qt.a,{children:Object(v.jsx)(gn.b,{initialValues:Object(yn.cloneDeep)(t||{}),onSubmit:r,validate:c,children:function(e){var t,n,r,c,o,i,s,u,l,d,j,b,h,f,p,m,O,x,g,y,w,k,S,C,D,T,E,M;return Object(v.jsxs)("form",{onSubmit:e.handleSubmit,children:[Object(v.jsx)(gn.a,{as:Sn.a,className:a.inputRow,name:"customer.name",label:"name",error:null===(t=e.errors)||void 0===t||null===(n=t.customer)||void 0===n?void 0:n.name,helperText:null===(r=e.errors)||void 0===r||null===(c=r.customer)||void 0===c?void 0:c.name,fullWidth:!0}),Object(v.jsx)(gn.a,{as:Sn.a,className:a.inputRow,error:null===(o=e.errors)||void 0===o||null===(i=o.customer)||void 0===i?void 0:i.mobile,helperText:null===(s=e.errors)||void 0===s||null===(u=s.customer)||void 0===u?void 0:u.mobile,name:"customer.mobile",label:"mobile",fullWidth:!0}),Object(v.jsx)(gn.a,{as:Sn.a,className:a.inputRow,name:"customer.email",label:"email",error:null===(l=e.errors)||void 0===l||null===(d=l.customer)||void 0===d?void 0:d.email,helperText:null===(j=e.errors)||void 0===j||null===(b=j.customer)||void 0===b?void 0:b.email,fullWidth:!0}),Object(v.jsxs)(qn,{className:a.inputRow,children:[Object(v.jsx)(Wn.a,{utils:Fn.a,children:Object(v.jsx)(Hn.a,{className:a.flexItem,value:new Date(e.values.start),onChange:function(t){e.setFieldValue("start",t,!0)},label:"start time"})}),Object(v.jsx)(Wn.a,{utils:Fn.a,children:Object(v.jsx)(Hn.a,{className:a.flexItem,value:e.values.end,onChange:function(t){e.setFieldValue("end",t,!0)},label:"end time"})}),Object(v.jsx)(Wn.a,{utils:Fn.a,children:Object(v.jsx)(In.a,{className:a.flexItem,value:e.values.start,onChange:function(t){e.setFieldValue("start",_n(t,e.values.start),!0),e.setFieldValue("end",_n(t,e.values.end),!0),console.log("hello")},label:"date"})})]}),Object(v.jsxs)(qn,{className:a.inputRow,children:[Object(v.jsx)(gn.a,{className:a.flexItem,as:Sn.a,name:"charges.hourlyRate",label:"hourly rate",error:null===(h=e.errors)||void 0===h||null===(f=h.charges)||void 0===f?void 0:f.hourlyRate,helperText:null===(p=e.errors)||void 0===p||null===(m=p.charges)||void 0===m?void 0:m.hourlyRate,fullWidth:!0}),Object(v.jsx)(gn.a,{className:a.flexItem,as:Sn.a,name:"charges.fuelCharge",label:"fuelCharge",error:null===(O=e.errors)||void 0===O||null===(x=O.charges)||void 0===x?void 0:x.fuelCharge,helperText:null===(g=e.errors)||void 0===g||null===(y=g.charges)||void 0===y?void 0:y.fuelCharge,fullWidth:!0}),Object(v.jsx)(gn.a,{className:a.flexItem,as:Sn.a,name:"charges.travelTime",label:"travelTime",error:null===(w=e.errors)||void 0===w||null===(k=w.charges)||void 0===k?void 0:k.travelTime,helperText:null===(S=e.errors)||void 0===S||null===(C=S.charges)||void 0===C?void 0:C.travelTime,fullWidth:!0})]}),Object(v.jsx)(gn.a,{as:Sn.a,className:a.inputRow,name:"items",label:"items",error:null===(D=e.errors)||void 0===D?void 0:D.items,helperText:null===(T=e.errors)||void 0===T?void 0:T.items,fullWidth:!0,multiline:!0,rows:5}),Object(v.jsx)(Nn,{value:e.values.addresses,onChange:e.handleChange,label:"add address",name:"addresses",itemName:"address",errors:null===(E=e.errors)||void 0===E?void 0:E.addresses}),Object(v.jsx)(Nn,{value:e.values.operatives,onChange:e.handleChange,label:"add operative",name:"operatives",itemName:"operative",errors:null===(M=e.errors)||void 0===M?void 0:M.operatives}),Object(v.jsx)(ke.a,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,children:"save"})]})}})})]})})}function Un(){var e=Object(y.i)().id,t=(Object(w.d)(),Object(y.g)()),n=I(e),r=n.data,a=n.isFetching,c=z(),o=Object(Ge.a)(c,2),i=o[0];o[1].isLoading;return a?null:Object(v.jsx)(Yn,{handleSubmit:function(e){i(e),t.goBack()},initialValues:r,title:"Edit Job"})}function Qn(){Object(w.d)();var e=function(){var e=Object(y.h)().search;return a.a.useMemo((function(){return new URLSearchParams(e)}),[e])}(),t=Object(y.g)();var n=P(),r=Object(Ge.a)(n,2),c=r[0],o=(r[1].isLoading,function(){var t=Object(Me.a)(e.get("iso-date"));return{start:Object(ee.default)(t,1*e.get("hour")),end:Object(ee.default)(t,1*e.get("hour")+1)}}()),i=function(){var e=Object(E.a)(T.a.mark((function e(n){return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c(n).unwrap();case 3:t.goBack(),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error("failed to save the new job");case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsx)(Yn,{handleSubmit:i,initialValues:o,title:"Create Joby"})}function Zn(){return $n.apply(this,arguments)}function $n(){return($n=Object(E.a)(T.a.mark((function e(){var t,n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F;case 2:return t=e.sent,e.next=5,t.getTokenSilently();case 5:return n=e.sent,e.abrupt("return",fetch("http://localhost:8000/api/v1/users",{headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){return e})).catch((function(e){return console.error(e)})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xn(){return Kn.apply(this,arguments)}function Kn(){return(Kn=Object(E.a)(T.a.mark((function e(){var t,n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F;case 2:return t=e.sent,e.next=5,t.getTokenSilently();case 5:return n=e.sent,e.abrupt("return",fetch("http://localhost:8000/api/v1/users",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify({})}).then((function(e){return e})).catch((function(e){return console.error(e)})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function er(){return tr.apply(this,arguments)}function tr(){return(tr=Object(E.a)(T.a.mark((function e(){var t,n;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Zn();case 3:if(200!==(t=e.sent).status){e.next=8;break}return e.next=7,t.json();case 7:return e.abrupt("return",e.sent);case 8:return e.next=10,Xn();case 10:if(200!==(n=e.sent).status){e.next=15;break}return e.next=14,n.json();case 14:return e.abrupt("return",e.sent);case 15:throw new Error("these are not the status codes you are looking for");case 18:e.prev=18,e.t0=e.catch(0),console.error(e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})))).apply(this,arguments)}function nr(e){return rr.apply(this,arguments)}function rr(){return(rr=Object(E.a)(T.a.mark((function e(t){var n,r;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F;case 2:return n=e.sent,e.next=5,n.getTokenSilently();case 5:return r=e.sent,e.next=8,fetch("http://localhost:8000/api/v1/gcal/authourize?code=".concat(t),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)}});case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ar="http://localhost:8000";console.log(ar);var cr=Object(k.d)({name:"auth",initialState:{isAuthenticated:!1,isAuthorizedToGcal:!1,loading:!0,token:null},reducers:{startLoading:function(e,t){e.loading=!0},stopLoading:function(e,t){e.loading=!1},authenticationSuccess:function(e,t){e.isAuthenticated=!0,e.token=t.payload},authorizedToGcalSuccess:function(e,t){e.isAuthorizedToGcal=!0},logOut:function(e,t){e.isAuthorizedToGcal=!1,e.isAuthenticated=!1,e.loading=!1}}}),or=function(){var e=Object(E.a)(T.a.mark((function e(t,n){var r;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F;case 2:return r=e.sent,e.next=5,r.loginWithRedirect({redirect_uri:"".concat(ar,"/auth")});case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ir=cr.actions,sr=function(){var e=Object(E.a)(T.a.mark((function e(t,n){var r,a;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t(ir.startLoading()),e.next=4,F;case 4:return r=e.sent,e.next=7,r.isAuthenticated();case 7:if(e.sent){e.next=10;break}return e.abrupt("return",t(ir.logOut()));case 10:return e.next=12,r.getTokenSilently();case 12:return a=e.sent,t(ir.authenticationSuccess(a)),e.next=16,er();case 16:e.sent.data.authorizedToGcal&&t(ir.authorizedToGcalSuccess()),t(ir.stopLoading()),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(0),console.error(e.t0);case 24:case"end":return e.stop()}}),e,null,[[0,21]])})));return function(t,n){return e.apply(this,arguments)}}(),ur=function(e){return function(){var t=Object(E.a)(T.a.mark((function t(n,r){var a;return T.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Zn();case 3:if(t.sent){t.next=6;break}throw new Error("you cant authorize a user if they dont exist");case 6:return t.next=8,nr(e);case 8:return a=t.sent,t.next=11,a.json();case 11:t.sent.data.authorizedToGcal&&n(ir.authorizedToGcalSuccess()),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(0),console.error(t.t0);case 18:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(e,n){return t.apply(this,arguments)}}()},lr=function(){var e=Object(E.a)(T.a.mark((function e(t,n){var r;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F;case 2:return r=e.sent,e.next=5,r.logout({returnTo:"".concat(ar,"/")});case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),dr=cr.reducer;function jr(){var e=function(){var e=Object(y.h)().search;return a.a.useMemo((function(){return new URLSearchParams(e)}),[e])}(),t=Object(w.d)(),n=Object(w.e)((function(e){return e.auth.isAuthenticated})),r=Object(y.g)();return a.a.useEffect((function(){var n=e.get("code"),r=e.get("state");console.log("state your conde",n,r),n&&r&&(console.log("fuck off"),t(function(){var e=Object(E.a)(T.a.mark((function e(t,n){var r;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F;case 2:return r=e.sent,e.next=5,r.handleRedirectCallback();case 5:t(sr);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()))}),[]),a.a.useEffect((function(){n&&r.push("/calendar")}),[n]),Object(v.jsx)("p",{children:"hello from auth"})}function br(){return Object(w.e)((function(e){return e.auth.isAuthorizedToGcal}))?Object(v.jsx)("p",{children:"you are authorized to Google Calendar yay!"}):Object(v.jsx)("button",{onClick:function(){fetch("http://localhost:8000/api/v1/gcal/url").then((function(e){return e.json()})).then((function(e){console.log(e),window.location.href=e.url}))},children:"authorize"})}function hr(){return Object(v.jsx)("p",{children:"this is the login page"})}function fr(){var e=function(){var e=Object(y.h)().search;return a.a.useMemo((function(){return new URLSearchParams(e)}),[e])}(),t=Object(w.d)();return a.a.useEffect((function(){function n(){return(n=Object(E.a)(T.a.mark((function n(){var r;return T.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:(r=e.get("code"))&&t(ur(r));case 2:case"end":return n.stop()}}),n)})))).apply(this,arguments)}!function(){n.apply(this,arguments)}()}),[]),Object(v.jsx)("p",{children:"hello"})}var pr={borderWidth:1,hourHeight:60},mr=Object(i.a)((function(e){return{root:{display:"flex"},appBar:{zIndex:e.zIndex.drawer+1},content:{flexGrow:1,padding:e.spacing(3)},wrapper:{display:"flex"}}}));var Or=function(){var e=mr();return Object(v.jsx)(y.d,{children:Object(v.jsxs)("div",{className:e.content,children:[Object(v.jsx)(u.a,{}),Object(v.jsx)(y.b,{path:"/error",children:Object(v.jsx)(_,{})}),Object(v.jsx)(Y,{children:Object(v.jsxs)(y.d,{children:[Object(v.jsx)(y.b,{path:"/calendar",children:Object(v.jsxs)(Q,{children:[Object(v.jsx)(Z.Provider,{value:pr,children:Object(v.jsx)(Lt,{})}),Object(v.jsxs)(y.d,{children:[Object(v.jsx)(y.b,{path:"/calendar/job-details/:id",children:Object(v.jsx)(ln,{})}),Object(v.jsx)(y.b,{path:"/calendar/gcal-details/:id",children:Object(v.jsx)(On,{})}),Object(v.jsx)(y.b,{path:"/calendar/edit-job-form/:id",children:Object(v.jsx)(Un,{})}),Object(v.jsx)(y.b,{path:"/calendar/create-job-form",children:Object(v.jsx)(Qn,{})})]})]})}),Object(v.jsx)(y.b,{path:"/auth",children:Object(v.jsx)(jr,{})}),Object(v.jsx)(y.b,{path:"/gcal",children:Object(v.jsx)(br,{})}),Object(v.jsx)(y.b,{path:"/login",children:Object(v.jsx)(hr,{})}),Object(v.jsx)(y.b,{path:"/oauthcallback",children:Object(v.jsx)(fr,{})}),Object(v.jsx)(y.b,{children:Object(v.jsx)(y.a,{to:"/calendar"})})]})})]})})},vr=n(428),xr=n(426),gr=n(431),yr=Object(gr.a)(xr.a)({color:"white"});function wr(){var e=Object(w.d)();return Object(v.jsx)(ke.a,{onClick:function(){return e(or)},color:"inherit",children:"Log In"})}function kr(){var e=Object(w.d)();return Object(v.jsx)(ke.a,{onClick:function(){e(lr)},color:"inherit",children:"Log Out"})}function Sr(e){e.color;var t=Object(w.e)((function(e){return e.auth.isAuthenticated}));return Object(w.e)((function(e){return e.auth.loading}))?Object(v.jsx)(yr,{}):t?Object(v.jsx)(kr,{}):Object(v.jsx)(wr,{})}var Cr=Object(i.a)((function(e){return{title:{flexGrow:1},root:{display:"flex"},appBar:{zIndex:e.zIndex.drawer+1}}}));var Dr=function(){var e=Cr();return Object(v.jsx)("div",{className:e.root,children:Object(v.jsx)(vr.a,{position:"fixed",className:e.appBar,children:Object(v.jsxs)(u.a,{children:[Object(v.jsx)(Se.a,{variant:"h6",className:e.title,children:"VanCal"}),Object(v.jsx)(Sr,{})]})})})},Tr=Object(i.a)((function(e){return{wrapper:{display:"flex",alignItems:"stretch",minHeight:"100%"},root:{height:"100%"}}}));var Er=function(){var e=Tr();return Object(v.jsx)("div",{className:e.root,children:Object(v.jsxs)(h.a,{children:[Object(v.jsx)(Dr,{}),Object(v.jsxs)("div",{className:e.wrapper,children:[Object(v.jsx)(g,{}),Object(v.jsx)(Or,{})]})]})})},Mr=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,436)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),c(e),o(e)}))},Nr=n(163),Rr=Object(k.a)({reducer:Object(Nr.a)({calendar:Be,auth:dr,errors:G},W.reducerPath,W.reducer),middleware:function(e){return e().concat(W.middleware)}});Rr.dispatch(sr),o.a.render(Object(v.jsx)(w.a,{store:Rr,children:Object(v.jsx)(Er,{})}),document.getElementById("root")),Mr()}},[[374,1,2]]]);
//# sourceMappingURL=main.5e3de81f.chunk.js.map